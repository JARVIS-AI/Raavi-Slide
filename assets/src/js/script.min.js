/**
 * So you are curious how it was done?
 *
 * It was quickly prototyped by trial and error, so code is full of not-so-very-best practices.
 * That's why you get uglified version here -- I don't want to make it too easy to learn from this crappy code ;)
 * And I don't want to make your life easier ;)
 * Anyway, if you really want to decypher it you will do it anyway, wouldn't you?
 *
 * It took me around ten evenings and one angry wife to code it, so appreciate ;)
 *
 *
 * Copyright 2011 Bartek Szopka
 *
 * P.S.
 * If you'd like to see it available as 'presentantion framework', drop me a line on twitter @bartaz.
 * I will probably do it anyway, but it will motivate me to do it faster ;)
 */
$(function(){function e(e){var t=e.data();$(".step.active").removeClass("active"),e.addClass("active"),$("#view").get(0).className="step-"+e.attr("id"),e={rotate:-parseInt(t.rotate,10),scale:1/parseFloat(t.scale)},e.x=-t.x,e.y=-t.y,s.css({"-webkit-transform":" scale("+e.scale+") ","-webkit-transition-delay":e.scale>i.scale?"300ms":"0"}).children(".rotate").css({"-webkit-transform":" rotate("+e.rotate+"deg) ","-webkit-transition":"","-webkit-transition-delay":e.scale>i.scale?"0":"300ms"}).children(".translate").css({"-webkit-transform":" translate("+e.x+"px,"+e.y+"px) ","-webkit-transition":"","-webkit-transition-delay":e.scale>i.scale?"0":"300ms"}),$.extend(i,e)}function t(e){var t=e.closest(".code").clone().find(".disabled").remove().end(),a=t.text().trim().replace(/\n/gi," ");e.closest(".step").find(".target "+(t.data("selector")||"")).css(t.data("property"),a||"")}function a(e){clearTimeout(n),n=setTimeout(function(){t(e)},50)}var s=$("#canvas").data("x","0").data("y","0").data("rotate","0").data("scale","1"),i=s.data();$(".step").each(function(){var e=$(this).data();$(this).css({"-webkit-transform":"translate(-50%,-50%)"+(" translate("+e.x+"px,"+e.y+"px) ")+(" rotate("+e.rotate+"deg) ")+(" scale("+e.scale+") ")})}),$(document).on("click",".step",function(){e($(this))}),$(document).on("keydown",function(t){if(32==t.keyCode||37<=t.keyCode&&40>=t.keyCode){var a=null;switch(t.keyCode){case 37:case 38:a=$(".step.active").prev(),a.length||(a=$(".step:last"));break;case 32:case 39:case 40:a=$(".step.active").next(),a.length||(a=$(".step:first"))}e(a),t.preventDefault()}});var n=null;$(document).on("dblclick",".switch",function(){return $(this).toggleClass("disabled"),a($(this)),!1}).on("dblclick",".flip",function(e){$(e.target).is(".snippet")&&$(this).toggleClass("back")}),$(".slider input[type=range]").on("change",function(){var e=$(this).val(),t=$(this).data("divider")||1,e=e/t;parseFloat(e),e=""+e.toFixed(1),1==t&&(e=parseFloat(e)),$(this).closest("label").find(".val").text(e),a($(this))});var o=$(document),c=$("#perspective").find(".scene"),r=c.find(".cross"),l=r.height()/2,d=r.width()/2;c.on("mousedown",function(e){var t=r.position();return o.on("mousemove.drag",function(a){var s=t.left+a.pageX-e.pageX,a=t.top+a.pageY-e.pageY;return r.css({left:s,top:a}),c.css("-webkit-perspective-origin",s+d+"px "+(a+l)+"px"),$("code .origin .value").text(~~(s+d)+"px "+~~(a+l)+"px"),!1}),!1}),o.on("mouseup",function(){o.off("mousemove.drag")}),$("#transforms3d-box .cube").css("-webkit-transform-style","preserve-3d"),$(".step:first").click(),$(".step:has(.target) .code").each(function(){t($(this).children().eq(0))})});